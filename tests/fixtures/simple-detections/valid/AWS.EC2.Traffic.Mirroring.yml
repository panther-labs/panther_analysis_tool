# Copyright (C) 2022 Panther Labs, Inc.
#
# The Panther SaaS is licensed under the terms of the Panther Enterprise Subscription
# Agreement available at https://panther.com/enterprise-subscription-agreement/.
# All intellectual property rights in and to the Panther SaaS, including any and all
# rights to access the Panther SaaS, are governed by the Panther Enterprise Subscription Agreement.

AnalysisType: rule
DisplayName: AWS EC2 Traffic Mirroring
Severity: Medium
Enabled: true
LogTypes:
  - AWS.CloudTrail
RuleID: AWS.EC2.Traffic.Mirroring
Detection:
  - DeepKey:
      - userIdentity
      - invokedBy
    Condition: DoesNotEndWith
    Value: '.amazonaws.com'
  - Key: eventSource
    Condition: Equals
    Value: 'ec2.amazonaws.com'
  - Key: eventName
    Condition: IsIn
    Values:
      - 'CreateTrafficMirrorFilter'
      - 'CreateTrafficMirrorFilterRule'
      - 'CreateTrafficMirrorSession'
      - 'CreateTrafficMirrorTarget'
      - 'DeleteTrafficMirrorFilter'
      - 'DeleteTrafficMirrorFilterRule'
      - 'DeleteTrafficMirrorSession'
      - 'DeleteTrafficMirrorTarget'
      - 'DescribeTrafficMirrorFilters'
      - 'DescribeTrafficMirrorSessions'
      - 'DescribeTrafficMirrorTargets'
      - 'ModifyTrafficMirrorFilterNetworkServices'
      - 'ModifyTrafficMirrorFilterRule'
      - 'ModifyTrafficMirrorSession'
